<odoo>
	<data>

<!--  -->
		<record id="view_model_fields_form_inherit" model="ir.ui.view">
			<field name="model">ir.model.fields</field>
			<field name="inherit_id" ref="base.view_model_fields_form" />
			<field name="arch" type="xml">
				<xpath expr="//sheet" position="before">
					<header position='inside'>
						<button name="toggle_webhook" string="Webhook" type="object" />
					</header>
				</xpath>
				<field name='model_id' position="after">
					<field name="webhook"/>
				</field>
			</field>
		</record>

		<record id="view_model_form_inherit" model="ir.ui.view">
			<field name="model">ir.model</field>
			<field name="inherit_id" ref="base.view_model_form" />
			<field name="arch" type="xml">
				<xpath expr="//sheet" position="before">
					<header>
						<button type="object" name="init_webhook"
							string="Initialize Webhook" />
					</header>
				</xpath>
				<field name="modules" position="before">
					<field name="webhook" />
				</field>
				<xpath expr="//field[@name='field_id']" position="attributes">
					<attribute name='options'>{'reload_on_button': true}</attribute>
				</xpath>
				<xpath expr="//field[@name='field_id']/tree" position="attributes">
					<attribute name='decoration-success'>webhook</attribute>
					<!-- <attribute name='default_order'>webhook</attribute> -->
				</xpath>
				<xpath expr="//field[@name='field_id']/tree" position="inside">
					<field name="webhook" />
					<button name="toggle_webhook" type="object" string='Toggle webhook'/>
				</xpath>
				<xpath expr="//page[1]" position="before">
					<page string="Webhook"
						attrs="{'invisible':[('webhook','=',False)]}">
						<field name="webhook_ids" />
					</page>
					<page string="Webhook Field"
						attrs="{'invisible':[('webhook','=',False)]}">
						<field name="webhook_field_ids" />
					</page>
					<page string="Webhook MQ"
						attrs="{'invisible':[('webhook','=',False)]}">
						<field name="webhook_mq_ids">
							<tree>
								<field name="write_date" />
								<field name="status_code" />
							</tree>
						</field>
					</page>
				</xpath>
			</field>
		</record>

		<record id="webhook_get_records_wizard" model="ir.ui.view" >
			<field name="name">webhook.get.records.wizard</field>
			<field name="model">webhook.get.records.wizard</field>
			<field name="arch" type="xml">
				<form>
					<div style="white-space: pre-line;">
						<p><h5>Select model to get data from IZI.</h5></p>
					</div>
					<group>
						<group>
							<field name="model_id"/>
						</group>
						<group>
						</group>
					</group>
					<footer>
						<button type="object" name="process_wizard" string="Process" class="oe_highlight"/>
						or
						<button string="Cancel" class="oe_link" special="cancel" />
					</footer>
				</form>
			</field>
		</record>

		<record id="webhook_get_custom_model_records_wizard" model="ir.ui.view">
			<field name="name">webhook.get.custom.model.records.wizard</field>
			<field name="model">webhook.get.custom.model.records.wizard</field>
			<field name="arch" type="xml">
				<form>
					<div style="white-space: pre-line;">
						<p>
							<h5>Select model to get data from IZI.</h5>
						</p>
					</div>
					<group>
						<field name="custom_model_name"/>
					</group>
					<footer>
						<button type="object" name="process_wizard" string="Process" class="oe_highlight"/>
						or
						<button string="Cancel" class="oe_link" special="cancel" />
					</footer>
				</form>
			</field>
		</record>

		<record id="view_webhook_server_form" model="ir.ui.view">
			<field name="model">webhook.server</field>
			<field name="arch" type="xml">
				<form string="Webhook Server">
					<header>
						<button class="btn-izi" name="remote" string="Access IZI App" type="object" />
						<!-- NO MORE ONE CLICK INIT -->
						<!-- <button type="object" name="initialize" string="Initialize" /> -->
						<button type="object" name="sync_order" string="Sync Recent Orders" />

						<button groups="base.group_no_one" name="upsert_menu" string="Create Menu" type="object" />
						<button groups="base.group_no_one" name="delete_menu" string="Delete Menu" type="object" />
						<button invisible="1" class="btn-izi-danger" confirm="Are you sure you want to do delete all data related to IZI? This action cannot be undone!" groups="base.group_no_one" type="object" name="delete_data" string="Delete All Data" />
						<button invisible="1" class="btn-izi-danger" confirm="Are you sure you want to do delete staging and attribute related to IZI? This action cannot be undone!" groups="base.group_no_one" type="object" name="delete_staging_and_attribute" string="Delete Staging and Attribute" />
					</header>
					<header>
						<button confirm="Make sure the warehouse mapping is correct. Click OK to continue!"  groups="base.group_no_one" type="object" name="get_accounts" string="1. Get Accounts" />
						<button groups="base.group_no_one" type="object" name="get_product_brand" string="2. Get Product Brand" />
						<button groups="base.group_no_one" type="object" name="get_product_category" string="3. Get Product Category" />
						<button groups="base.group_no_one" type="object" name="get_dependency" string="4. Get Dependency" />

						<button confirm="Make sure the product mapping is correct. Click OK to continue!" groups="base.group_no_one" type="object" name="get_product_templates" string="5. Get Product Templates" />
						<button confirm="Make sure the product mapping is correct. Click OK to continue!" groups="base.group_no_one" type="object" name="get_product_stagings" string="6. Get Product Stagings" />
						<button confirm="Make sure the product mapping is correct. Click OK to continue!" groups="base.group_no_one" type="object" name="get_product_products" string="7. Get Product Products" />
						<button confirm="Make sure the product mapping is correct. Click OK to continue!" groups="base.group_no_one" type="object" name="get_product_discounts" string="8. Get Product Discount" />
						<button confirm="Make sure the product mapping is correct. Click OK to continue!" groups="base.group_no_one" type="object" name="after_get_products" string="9. Proccess After Get Product" />
						<button confirm="Make sure the product mapping is correct. Click OK to continue!" groups="base.group_no_one" type="object" name="get_product_staging_variants" string="10. Get Product Staging Variants" />
						<button confirm="Make sure the product mapping is correct. Click OK to continue!" groups="base.group_no_one" type="object" name="get_product_marketplace_attributes" string="11. Get Product MP Attributes" />

						<button confirm="Are you sure to import ALL ORDERS from marketplace? This action can not be undone!" class="btn-izi-danger" groups="base.group_no_one" type="object" name="get_orders" string="12. Get All Orders" />
						<button confirm="Are you sure to import ALL STOCK DATA from marketplace? This action can not be undone!" class="btn-izi-danger" groups="base.group_no_one" type="object" name="import_stock" string="13. Import Stock" />
						<button confirm="Are you sure to export ALL STOCK DATA to marketplace? This action can not be undone!" class="btn-izi-danger" groups="base.group_no_one" type="object" name="export_stock" string="Export Stock" />
					</header>
					<sheet>
						<group>
							<group>
								<field name="name" />
								<field name="username" />
								<field name="password" password="1" />
								<field name="session_id" readonly="1" />
							</group>
							<group>
								<field name="active" />
								<field name="cron_id" />
								<field name="get_records_time_limit" />
								<!-- <field name="compress" /> -->
							</group>
						</group>
						<group invisible='1'>
							<field name="access_token" readonly="1" />
							<field name="expires_at" readonly="1" />
						</group>
						
						<notebook>
							<page string="Sync Configuration">
								<group>
									<field name="is_skip_error" widget='boolean_toggle'/>
									<p class="sub-label">Skip error when getting records then write logs.</p>
									<field name="is_skip_product_not_mapping" widget='boolean_toggle'/>
									<p class="sub-label">Do not create or update product in Odoo if not mapped in product mapping.</p>
									<field name="is_skip_image" widget='boolean_toggle'/>
									<p class="sub-label">Do not save product image from marketplace to Odoo database.</p>
									<field name="is_quotation_only" widget='boolean_toggle'/>
									<p class="sub-label">Always get new order as quotation regardless its state from marketplace.</p>
									<field name="skip_cancel_order" widget='boolean_toggle'/>
									<p class="sub-label">Do not import cancelled order from marketplace.</p>
									<field name="skip_waiting_order" widget='boolean_toggle'/>
									<p class="sub-label">Do not import unpaid order from marketplace.</p>
									<field name="check_invoice_number" widget='boolean_toggle'/>
									<p class="sub-label">Always check existing marketplace invoice number before saving order.</p>
									<field name="is_shipping_address" widget='boolean_toggle'/>
									<p class="sub-label">Use shipping address instead of customer field in order.</p>
									<field name="no_action_marketplace" widget='boolean_toggle'/>
									<p class="sub-label">Prevent all action to marketplace when triggerred in Odoo.</p>
									<field name="no_action_picking_marketplace" widget='boolean_toggle'/>
									<p class="sub-label">Prevent delivery action to marketplace when triggerred in Odoo.</p>
								</group>
							</page>
							<page string="Records Logs">
								<button class="btn-izi" type="object" name="retry_get_records" string="Retry" icon="fa-refresh"/>
								<field name="log_ids">
									<tree>
										<button type="object" name="retry_get_record" icon="fa-refresh" />
										<field name="last_retry_time" readonly="1"/>
										<field name="model_name" readonly="1"/>
										<field name="izi_id" readonly="1"/>
										<field name="res_id" invisible="1"/>
										<field name="error_message" readonly="1"/>
										<field name="status" readonly="1"/>
										<field name="notes" readonly="1"/>
									</tree>
								</field>
							</page>
							<page string="Model" invisible="1">
								<field name="model_ids" options="{'reload_on_button': true}">
									<tree decoration-muted="(not webhook_field_ids)">
										<field name="model" />
										<field name="name" />
                                        <field name="webhook_field_ids" />
                                        <!-- <button name="set_default_webhook" string="Add default fields" type="object"/> -->
									</tree>
								</field>
								<button name="build_dependency" type="object"
									string="Build Dependency" />
								<button name="clear_dependency" type="object"
									string="Clear Dependency" />
								<button name="build_dependency_field" type="object"
									string="Build Dependency Field" />
								<button name="clear_dependency" type="object"
									string="Clear Dependency" />
								<button name="set_default_available_webhook"
									type="object"
									string="Get default Model &amp; Fields" />
							</page>
							<page string="MQ" invisible="1">
								<field name="mq_ids" />
							</page>
						</notebook>

					</sheet>
				</form>
			</field>
		</record>

		<record id="view_webhook_server_tree" model="ir.ui.view">
			<field name="model">webhook.server</field>
			<field name="arch" type="xml">
				<tree string="Webhook Server" decoration-muted="(not active)">
					<field name="name" />
					<field name="active" widget='boolean_toggle'/>
				</tree>
			</field>
		</record>

		<record id="view_webhook_server_mq_tree" model="ir.ui.view">
			<field name="model">webhook.server.mq</field>
			<field name="arch" type="xml">
				<tree string="Webhook Server MQ" decoration-danger="(retry)">
					<field name="write_date" />
					<field name="res_model_id" />
					<field name="status_code" />
					<field name="retry" />
					<field name="is_patch" />
					<button name="send_request" string="Manual sync" type="object" class='btn btn-sm btn-warning'/>
				</tree>
			</field>
		</record>

		<record id="view_webhook_server_search" model="ir.ui.view">
			<field name="model">webhook.server</field>
			<field name="arch" type="xml">
				<search string="Webhook Server">
					<field name="name" />
					<field name="active" />
					<separator />
					<filter string="All" name="all"
						domain="['|',('active','=',False),('active','=',True)]" />
				</search>
			</field>
		</record>

		<record id="webhook_server_act" model="ir.actions.act_window">
			<field name="name">Webhook Server</field>
			<field name="res_model">webhook.server</field>
			<field name="type">ir.actions.act_window</field>
			<field name="view_mode">tree,form</field>
			<field name="context">{'search_default_all': 1}</field>
            <field name="search_view_id" ref="view_webhook_server_search"/>
		</record>

		<record id="webhook_server_mq_act"
			model="ir.actions.act_window">
			<field name="name">Webhook Server MQ</field>
			<field name="res_model">webhook.server.mq</field>
			<field name="type">ir.actions.act_window</field>
			<field name="view_mode">tree,form</field>
		</record>

		<menuitem name="Configuration"
			id="menu_webhook" sequence="300"
            web_icon="juragan_webhook,static/img/izi_config.png" groups="juragan_webhook.group_izi_webhook_configuration_manager"/>
            <menuitem name="Server Configuration"
            	id="menu_webhook_server"
				parent="menu_webhook"
				action="webhook_server_act"/>
			<!-- <menuitem name="Message Queue"
				id="menu_webhook_mq"
				parent="menu_webhook"
				action="webhook_server_mq_act" /> -->
	</data>
</odoo>
